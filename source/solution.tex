\section{Solving the multi-objective WSN problem}
\label{section:solution}
As defined in the previous Section, we seek a method to optimise multiple objectives in our WSN system. To do so we will incorporate two algorithms. We give the high-level purpose and requirements of each algorithm in the next sections, however, full details and theoretical justification can be found in \cite{creech2021dynamic, creech2021resource}.

\subsection{Optimisation algorithms for task allocation and resource allocation}
%%%%%%%%%%%%%%%%
\newcommand{\varAction}[2]{\varSymbol{a}{#1}{#2}}
\newcommand{\functionExec}[2]{\texttt{exec}(\varAtomicTask{}{})}
\newcommand{\functionAlloc}[2]{\texttt{alloc}(\varAtomicTask{}{}, \varAgent{}{})}
\newcommand{\functionInfo}[2]{\texttt{info}(\varAgent{}{})}
\newcommand{\functionLink}[2]{\texttt{link}(\varAgent{}{})}
\newcommand{\functionATARIA}[2]{
	\functionSignature{
		ataria_{\varAgent{}{}}
	}{
		\varAtomicTask{}{}, \varAgent{self}{}
	}
}	
\newcommand{\formalATARIA}[2]{
	\functionFormal{\texttt{ataria}_{\varAgent{}{}}}
	{\setAtomicTask{}{} \times \setAgents{}{}}
	{
	\texttt{exec}(\setAtomicTask{}{})
	\times \texttt{alloc}(\setAtomicTask{}{}, \setAgents{}{})
	\times \texttt{info}(\setAgents{}{})
	\times \texttt{link}(\setAgents{}{})
}
}
\newcommand{\functionMGRAO}[2]{\texttt{mgrao}(\varAtomicTask{}{}, \varAgent{self}{})}
\newcommand{\formalMGRAO}[2]{
	\functionFormal{\texttt{mgrao}_{\varAgent{}{}}}
	{XXXX}
	{
		XXXX
	}
}
\newcommand{\functionMGRAOUpdate}[2]{
	\texttt{mgrao-update}
	(\varAtomicTask{}{}, \functionTaskArc{}{}, atv(ct, at))}
%%%%%%%%%%%%
	
The \acronymATARIAExtended{}{} algorithm enables agents in the system to learn the best actions to take given their current state. This ranges from deciding which other agents to allocate tasks to and obtain the best composite task values, to exploring the system for other agents, and adapting connectivity to handle network disruption. An agent uses the \acronymATARIA{}{} algorithm to choose an action to take, which can be one of the following,
\begin{enumerate}
	\item $\functionExec{}{}$, The agent will execute the atomic task $\varAtomicTask{}{}$ itself.
	\item $\functionAlloc{}{}$, the agent will allocate the atomic task $\varAtomicTask{}{}$ to another agent $\varAgent{}{}$.
	\item $\functionInfo{}{}$, the agent will request information from another agent $\varAgent{}{}$.
	\item $\functionLink{}{}$, the agent will allocate resources to hold information on the agent $\varAgent{}{}$ and maintain a connection.
\end{enumerate}
The \acronymATARIA{}{} algorithm learns to select the actions that generate the best composite task values, and adapt the choice of action depending on how good the composite task values are in comparison to the historical values. We simplify the details of 
the algorithm as the following function, which will select one of the possible actions for the agent $\varAgent{}{}$, given it has non-completed, allocated tasks $\setAtomicTask{}{}$.
\begin{equation}
	\label{eq:ataria}
	\formalATARIA{}{}
\end{equation}

The \acronymMGRAOExtended{}{} algorithm helps agents executing measurement tasks allocate their resources to optimise the composite task value as well. 
\begin{equation}
	\label{eq:mgrao}
	\formalMGRAO{}{}
\end{equation}
\todo[inline]{Dedine MGRAO upadte here}
Definition 3.14 (Component tasks absolute value). The absolute value of each component atomic task of a composite
task Ë†ğ‘¡ executed at time ğœ™ is expressed by a mapping from the atomic tasks comprising Ë†ğ‘¡ to the actual value provided
by that task according to the quality of the composite task and the proportional value of the atomic task within the
composite, ğ‘ğ‘¡ğ‘£ : ğ‘‡Ë† Ã—ğ‘‡ â†’ R, such that ğ‘ğ‘¡ğ‘£ (ğ‘¡Ë†, ğ‘¡ ) = ğ‘¡ğ‘ğ‘ğœ™ (ğ‘¡Ë†)ğ‘ğ‘¡ğ‘£ (ğ‘¡ )

\subsection{Extension to hierarchical task allocation}

To enable agents to form arcs as described we allow atomic tasks to be re-allocated to further agents in order to reach an agent within range of a demand point. Figure \ref{fig:arc-flow} illustrates an arc where there are two re-allocations needed before a specific atomic task is allocated to an agent whose sensor is in range of the demand point, and can therefore make a measurement.

\begin{figure}[ht]
	\centering
	\includegraphics[width=0.8\linewidth]{arc-flow}
	\caption{\textbf{Allocation along an arc}. This diagram illustrates how allocations can be relayed along an arc using successive applications of the \acronymATARIA{}{} algorithm.}
	\label{fig:arc-flow}
\end{figure}

